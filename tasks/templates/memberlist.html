{% extends 'base.html' %}
{% block title %}Members{% endblock %}
{% block actions %}
<a href="{% url "MemberForm" %} "  class="px-3 py-2 rounded bg-blue-600 text-white">+ Add Member</a>
{% endblock %}
{% block content %}
<h1 class="text-2xl font-semibold mb-4">Members</h1>
<form method="get" class="mb-4 flex gap-2">
<input type="text" name="q" value="{{ request.GET.q }}" placeholder="Search name/phone" class="border rounded px-3 py-2 w-64" />
<button class="px-3 py-2 rounded bg-gray-800 text-white">Search</button>
</form>
<div class="overflow-x-auto bg-white rounded shadow">
<table class="w-full text-left">
<thead class="bg-gray-100">
<tr>
<th class="p-3">#</th>
<th class="p-3">Photo</th>
<th class="p-3">Name</th>

<th class="p-3">Phone</th>



<th class="p-3">Package</th>
<th class="p-3">Payment Status</th>


<th class="p-3">Actions & Details</th>
</tr>
</thead>
<tbody>
{% for m in members %}
<tr class="border-t">
<td class="p-3">{{ forloop.counter }}</td>

<td class="p-3">
{% if m.photo %}
  <img src="{{ m.photo.url }}" alt="" class="w-10 h-10 rounded-full object-cover">
{% else %}
  <span class="text-gray-400 text-sm">No Photo</span>
{% endif %}


<td class="p-3 font-medium">{{ m.name }}</td>

<td class="p-3">{{ m.phone }}</td>
<td class="p-3">{{ m.plan}}</td>
<td class="p-3">
    {% with last_payment=m.payments.last %}
        {% if last_payment %}
            {{ last_payment.status }}
        {% else %}
            <span class="text-gray-400">No Payment</span>
        {% endif %}
    {% endwith %}
</td>



<td class="p-3 flex gap-2">
<a href="{% url 'member_details' m.id %}" class="px-2 py-1 rounded bg-green-600 text-white text-sm">Click Here</a>

</td>

{% empty %}
<tr><td colspan="6" class="p-3 text-center text-gray-500">No members found.</td></tr>
{% endfor %}
</tbody>
</table>
</div>
{% endblock %}